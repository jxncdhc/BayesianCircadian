source("~/jiyin/Bayesian circadian/simulation prior 02_25_24/rjmcmc_generate_data.R", echo=TRUE)
source("~/jiyin/Bayesian circadian/simulation prior 02_25_24/Bayes_rhythmicity.R", echo=TRUE)
source("~/jiyin/Bayesian circadian/simulation prior 02_25_24/Bayesian_rhythmicity_with_prior.R", echo=TRUE)
simdata <- rjmcmc_getSimData(n=24)
yy <- simdata$Y
tt <- simdata$time
qvalue <- bayes_rhythmicity(yy=yy,tt=tt,M=200)
prior_info <- ifelse(qvalue<0.05,1,0)
qvalue <- bayes_rhythmicity(yy=yy,tt=tt,M=200)$qvalues
prior_info <- ifelse(qvalue<0.05,1,0)
simdata <- rjmcmc_getSimData(n=24)
yy <- simdata$Y
tt <- simdata$time
prior_info
bayes_rhythmicity_prior(yy=yy,tt=tt,M=200,prior_gene = prior_info)
source("~/jiyin/Bayesian circadian/simulation prior 02_25_24/test_with_prior_2.R", echo=TRUE)
source("~/jiyin/Bayesian circadian/simulation prior 02_25_24/test_with_prior_1.R", echo=TRUE)
source("~/jiyin/Bayesian circadian/simulation prior 02_25_24/test_with_prior_2.R", echo=TRUE)
source("~/jiyin/Bayesian circadian/simulation prior 02_25_24/test_with_prior_2.R", echo=TRUE)
source("~/jiyin/Bayesian circadian/simulation prior 02_25_24/test_with_prior_1.R", echo=TRUE)
source("~/jiyin/Bayesian circadian/simulation prior 02_25_24/rjmcmc_generate_data.R", echo=TRUE)
simdata <- rjmcmc_getSimData(n=24)
yy <- simdata$Y
tt <- simdata$time
qvalue <- bayes_rhythmicity(yy=yy,tt=tt,M=200)$qvalues
source("~/jiyin/Bayesian circadian/simulation prior 02_25_24/Bayes_rhythmicity.R", echo=TRUE)
simdata <- rjmcmc_getSimData(n=24)
yy <- simdata$Y
tt <- simdata$time
qvalue <- bayes_rhythmicity(yy=yy,tt=tt,M=200)$qvalues
prior_info <- ifelse(qvalue<0.05,1,0)
simdata <- rjmcmc_getSimData(n=24)
yy <- simdata$Y
tt <- simdata$time
bayes_rhythmicity_prior_1(yy=yy,tt=tt,M=200,prior_gene = prior_info,G1=100)
bayes_rhythmicity_prior_2(yy=yy,tt=tt,M=200,prior_gene = prior_info,G1=100)
bayes_rhythmicity_prior_2(yy=yy,tt=tt,M=200,prior_gene = prior_info,G1=100)
simdata <- rjmcmc_getSimData(n=24)
yy <- simdata$Y
tt <- simdata$time
bayes_out <- bayes_rhythmicity(yy=yy,tt=tt,M=200)
qvalue <- bayes_out$qvalues
prior_info <- ifelse(qvalue<0.05,1,0)
simdata <- rjmcmc_getSimData(n=24)
yy <- simdata$Y
tt <- simdata$time
bayes_rhythmicity_prior_2(yy=yy,tt=tt,M=200,prior_gene = prior_info,G1=100)
bayes_rhythmicity_prior_1(yy=yy,tt=tt,M=200,prior_gene = prior_info,G1=100)
sum(qvalue<0.05)
5/100
source("~/jiyin/Bayesian circadian/simulation prior 02_25_24/test_bayesian_prior_1.R", echo=TRUE)
test_prior(24,type=1,iter=5,MCMC_iter = 20)
source("~/jiyin/Bayesian circadian/simulation prior 02_25_24/test_bayesian_prior_1.R", echo=TRUE)
test_prior(24,type=1,iter=5,MCMC_iter = 20)
test_prior(24,type=2,iter=5,MCMC_iter = 20)
1:10^-3
(1:10)^-3
source("~/jiyin/BayesianCircadian/R/Bayes_rhythmicity.R", echo=TRUE)
ybig <- read_csv('~/Downloads/adata_sub_Ependymocytes.csv')
timebig <- read_csv('~/Downloads/phenotype_acell_sub_Ependymocytes.csv')$ct
library(tidyverse)
ybig <- read_csv('~/Downloads/adata_sub_Ependymocytes.csv')
timebig <- read_csv('~/Downloads/phenotype_acell_sub_Ependymocytes.csv')$ct
y <- as.matrix(ybig[1:20,-1])
View(y)
View(y)
bayes_rhythmicity(yy=y, tt=timebig, M=20)
library(invgamma)
bayes_rhythmicity(yy=y, tt=timebig, M=20)
y <- as.matrix(ybig[1:30,-1])
bayes_rhythmicity(yy=y, tt=timebig, M=20)
warnings()
warnings()
debugSource("~/jiyin/BayesianCircadian/R/Bayes_rhythmicity.R", echo=TRUE)
debugSource("~/jiyin/BayesianCircadian/R/Bayes_rhythmicity.R", echo=TRUE)
source("~/.active-rstudio-document", echo=TRUE)
source("~/.active-rstudio-document", echo=TRUE)
debugSource("~/Downloads/Bayes_test.R", echo=TRUE)
bayes_rhythmicity(yy=y, tt=timebig, M=20)
pr
source("~/Downloads/Bayes_test.R", echo=TRUE)
bayes_rhythmicity(yy=y, tt=timebig, M=20)
source("~/Downloads/Bayes_test.R", echo=TRUE)
source("~/Downloads/Bayes_test.R", echo=TRUE)
bayes_rhythmicity(yy=y, tt=timebig, M=20)
View(y)
ybig[26,]
unique(ybig[26,])
unique(unlist(ybig[26,]))
unique(unlist(ybig[26,-1]))
## https://yulab-smu.top/biomedical-knowledge-mining-book/clusterprofiler-kegg.html
##
library(tidyverse)
DE_BA11 <- read.csv("~/jiyin/Bayesian circadian/real data analysis/brain aging/brain_aging.csv")
library(clusterProfiler)
library(org.Mm.eg.db) ## this is for mouse
library(org.Hs.eg.db) ## this is for human
View(DE_BA11)
agenes <- DE_BA11 %>% filter(qvalues < 0.05) %>% select(gene_assignment)
eg = bitr(agenes$gene_assignment, fromType="SYMBOL", toType="ENTREZID", OrgDb="org.Hs.eg.db")
agenes <- DE_BA11 %>% filter(qvalues < 0.05)
eg = bitr(agenes$gene_assignment, fromType="SYMBOL", toType="ENTREZID", OrgDb="org.Hs.eg.db")
head(eg)
enrich_result <- enrichKEGG(gene = eg$ENTREZID,
organism = "hsa",  # for human, "mmu" for mouse
keyType = "ENTREZID",  # or "ENTREZID", etc.
pvalueCutoff  = 0.05,
qvalueCutoff  = 0.05)
enrich_result <- enrichKEGG(gene = eg$ENTREZID,
organism = "hsa",  # for human, "mmu" for mouse
keyType = "ENTREZID",  # or "ENTREZID", etc.
pvalueCutoff  = 0.05)
#y <- read_csv('~/Downloads/adata_sub_Ependymocytes_verysamll.csv')
ybig <- read_csv('~/Downloads/adata_sub_Ependymocytes.csv')
y <- as.matrix(ybig[1:30,-1])
unique(unlist(y[26,]))
x <- c(1:10)
y <- rep(1,10)
dataxy <- data.frame(x=x, y=y)
View(dataxy)
lm(y~x,data=dataxy)
summary(lm(y~x,data=dataxy))
rbeta(20,1,101)
rbeta(20,20,20)
1/100
rbeta(20,0,100)
rbeta(20,1,101)
rbeta(20,1,1)
source("~/jiyin/BayesianCircadian/R/Bayes_rhythmicity.R", echo=TRUE)
library(BayesianCircadian)
source("~/jiyin/Bayesian circadian/simulation 01_06_24/rjmcmc_generate_data.R", echo=TRUE)
simdata <- rjmcmc_getSimData(G=200,G1=20,n=24)
yy <- simdata$Y
time <- simdata$time
bayes_rhythmicity(yy,tt,M=500)
bayes_rhythmicity(yy,time,M=500)
out <- bayes_rhythmicity(yy,time,M=500)
out$qvalue
out$pvalue
vec <- c(1,1,1,0,0,0)
sum(vec)
vec <- c(1,1,1,0,0,0,0)
sum(vec)
sum(vec==0)
sum(vec==1)
source("~/jiyin/BayesianCircadian/R/Bayesian_rhythmicity_with_prior.R", echo=TRUE)
source("~/jiyin/BayesianCircadian/build bayesian circadian.R", echo=TRUE)
devtools::document(pkg='~/jiyin/BayesianCircadian')
devtools::build(pkg='~/jiyin/BayesianCircadian')
install.packages(file.path("~/jiyin","BayesianCircadian_0.0.0.9000.tar.gz"),repos=NULL,type="source")
